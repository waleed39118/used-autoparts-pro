<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AutoParts Pro - Entity Relationship Diagram</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 10px;
        }
        .header h1 {
            margin: 0;
            font-size: 2.5em;
        }
        .header p {
            margin: 10px 0 0 0;
            font-size: 1.2em;
            opacity: 0.9;
        }
        .diagram-container {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        .info-section {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .info-section h2 {
            color: #333;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        .entity-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .entity-card {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
        }
        .entity-card h3 {
            color: #495057;
            margin-top: 0;
            border-bottom: 1px solid #dee2e6;
            padding-bottom: 5px;
        }
        .entity-card ul {
            margin: 10px 0;
            padding-left: 20px;
        }
        .entity-card li {
            margin: 5px 0;
            font-size: 0.9em;
        }
        .relationships {
            background: #e3f2fd;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
        }
        .relationships h3 {
            color: #1976d2;
            margin-top: 0;
        }
        .tech-stack {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }
        .tech-badge {
            background: #667eea;
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 500;
        }
        .footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: #666;
            border-top: 1px solid #ddd;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üîß AutoParts Pro</h1>
        <p>Entity Relationship Diagram - Database Schema</p>
    </div>

    <div class="diagram-container">
        <div class="mermaid">
            erDiagram
                User {
                    ObjectId _id PK
                    string username UK "Unique, 3-30 chars"
                    string email UK "Unique, valid email"
                    string password "Hashed, min 6 chars"
                    enum role "user, admin"
                    string resetPasswordToken "For password reset"
                    date resetPasswordExpires "Token expiration"
                    date createdAt "Auto-generated"
                }

                CarType {
                    ObjectId _id PK
                    string name UK "Unique, e.g., Sedan, SUV"
                    date createdAt "Auto-generated"
                }

                CarModel {
                    ObjectId _id PK
                    string name "e.g., Toyota Camry"
                    ObjectId carType FK "References CarType"
                    date createdAt "Auto-generated"
                }

                PartLocation {
                    ObjectId _id PK
                    string name UK "Unique, e.g., Engine, Brakes"
                    date createdAt "Auto-generated"
                }

                SparePart {
                    ObjectId _id PK
                    string name "Part name"
                    string description "Optional description"
                    string image "Image file path"
                    number price "Must be positive"
                    ObjectId partLocation FK "References PartLocation"
                    ObjectId carType FK "References CarType"
                    ObjectId carModel FK "References CarModel"
                    ObjectId owner FK "References User"
                    date createdAt "Auto-generated"
                }

                User ||--o{ SparePart : "owns/creates"
                CarType ||--o{ CarModel : "contains"
                CarType ||--o{ SparePart : "fits"
                CarModel ||--o{ SparePart : "compatible"
                PartLocation ||--o{ SparePart : "categorizes"
        </div>
    </div>

    <div class="info-section">
        <h2>üìä Database Entities Overview</h2>
        <div class="entity-list">
            <div class="entity-card">
                <h3>üë§ User</h3>
                <ul>
                    <li><strong>Purpose:</strong> User authentication & authorization</li>
                    <li><strong>Key Features:</strong> Username, Email, Password hashing</li>
                    <li><strong>Roles:</strong> User, Admin</li>
                    <li><strong>Security:</strong> Bcrypt password hashing</li>
                </ul>
            </div>

            <div class="entity-card">
                <h3>üöó CarType</h3>
                <ul>
                    <li><strong>Purpose:</strong> Vehicle categorization</li>
                    <li><strong>Examples:</strong> Sedan, SUV, Hatchback, Pickup</li>
                    <li><strong>Constraint:</strong> Unique names</li>
                    <li><strong>Usage:</strong> Filtering and organization</li>
                </ul>
            </div>

            <div class="entity-card">
                <h3>üè∑Ô∏è CarModel</h3>
                <ul>
                    <li><strong>Purpose:</strong> Specific vehicle models</li>
                    <li><strong>Examples:</strong> Toyota Camry, Honda CR-V</li>
                    <li><strong>Relationship:</strong> Belongs to CarType</li>
                    <li><strong>Constraint:</strong> Unique per car type</li>
                </ul>
            </div>

            <div class="entity-card">
                <h3>üìç PartLocation</h3>
                <ul>
                    <li><strong>Purpose:</strong> Part categorization by location</li>
                    <li><strong>Examples:</strong> Engine, Brakes, Transmission</li>
                    <li><strong>Constraint:</strong> Unique names</li>
                    <li><strong>Usage:</strong> Part organization and search</li>
                </ul>
            </div>

            <div class="entity-card">
                <h3>üîß SparePart (Central Entity)</h3>
                <ul>
                    <li><strong>Purpose:</strong> Main marketplace items</li>
                    <li><strong>Features:</strong> Name, Description, Price, Image</li>
                    <li><strong>References:</strong> User, CarType, CarModel, PartLocation</li>
                    <li><strong>Validation:</strong> Positive price, required fields</li>
                </ul>
            </div>
        </div>
    </div>

    <div class="relationships">
        <h3>üîó Key Relationships</h3>
        <ul>
            <li><strong>User ‚Üí SparePart:</strong> One user can own multiple spare parts (1:N)</li>
            <li><strong>CarType ‚Üí CarModel:</strong> One car type contains multiple models (1:N)</li>
            <li><strong>CarType ‚Üí SparePart:</strong> Parts are categorized by car type (1:N)</li>
            <li><strong>CarModel ‚Üí SparePart:</strong> Parts are compatible with specific models (1:N)</li>
            <li><strong>PartLocation ‚Üí SparePart:</strong> Parts are categorized by location (1:N)</li>
        </ul>
    </div>

    <div class="info-section">
        <h2>üõ†Ô∏è Technology Stack</h2>
        <div class="tech-stack">
            <span class="tech-badge">MongoDB</span>
            <span class="tech-badge">Mongoose ODM</span>
            <span class="tech-badge">Node.js</span>
            <span class="tech-badge">Express.js</span>
            <span class="tech-badge">bcrypt</span>
            <span class="tech-badge">Multer</span>
            <span class="tech-badge">EJS Templates</span>
            <span class="tech-badge">Bootstrap 5</span>
        </div>
    </div>

    <div class="info-section">
        <h2>üîí Data Integrity & Security</h2>
        <ul>
            <li><strong>Referential Integrity:</strong> All foreign key references validated</li>
            <li><strong>Unique Constraints:</strong> Enforced at database level</li>
            <li><strong>Password Security:</strong> Automatic bcrypt hashing with salt</li>
            <li><strong>Input Validation:</strong> Client and server-side validation</li>
            <li><strong>File Security:</strong> Secure image upload with validation</li>
            <li><strong>Role-Based Access:</strong> Admin/User authorization levels</li>
        </ul>
    </div>

    <div class="footer">
        <p><strong>AutoParts Pro</strong> - Professional Automotive Marketplace Database Schema v1.0</p>
        <p>Designed for scalability, security, and performance</p>
    </div>

    <script>
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'neutral',
            erDiagram: {
                useMaxWidth: true
            }
        });
    </script>
</body>
</html>